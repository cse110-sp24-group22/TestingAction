name: Codeclimate quality

on:
  pull_request:
    branches:
      - main

jobs:
  # test:
  #   name: Test
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Checkout repository
  #       uses: actions/checkout@v4
  #       with:
  #         fetch-depth: 0

  #     - name: Install Dependencies
  #       run: |
  #         npm install
  #         npm install -g yarn
  #         yarn install
  #         yarn build
  #         yarn test

  coverage:
    # needs: [test]
    name: Coverage
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - run: |
          npm install -g yarn
          yarn install
          yarn build

      - uses: paambaati/codeclimate-action@v4
        env:
          CC_TEST_REPORTER_ID: ${{ secrets.CC_TEST_REPORTER_ID }}
        with:
          coverageCommand: yarn run coverage
          debug: true
